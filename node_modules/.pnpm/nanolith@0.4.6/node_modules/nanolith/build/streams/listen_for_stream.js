import{ReadableFromPort}from"./readable_from_port.js";export function listenForStream(e,t,a=0){const r=async r=>{if("stream-start"!==r.type)return;const o=()=>{const t=new ReadableFromPort(r.id,e,r.meta??{}),a={type:"stream-ready-to-consume",id:r.id};return e.postMessage(a),t};switch(a){default:return;case 0:return void await t(o());case 1:return void await t({metaData:r.meta,accept:()=>o()})}};return e.on("message",r),()=>{e.off("message",r)}}